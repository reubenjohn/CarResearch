from unittest import TestCase

from car_researcher.scrape.kbb_search import scrape_kbb_search, ListItem, PriceRibbon
from tests.scrape.fetch import StatelessTestVectorFetcher


class Test(TestCase):
    def test_scrape_kbb_search(self):
        results = scrape_kbb_search('kbb_search', StatelessTestVectorFetcher())
        self.assertEqual(results, EXPECTED_RESULTS)


EXPECTED_RESULTS = [
    ListItem(title='Used 2022 Porsche Cayenne S',
             first_price=91995,
             listing_id='686951775',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2020 BMW 330i xDrive Sedan',
             first_price=33888,
             listing_id='686810384',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2020 Porsche Taycan Turbo S',
             first_price=127995,
             listing_id='686714164',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Certified 2021 Kia Rio S',
             first_price=19193,
             listing_id='686842968',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Certified 2020 Chevrolet Equinox LT',
             first_price=23884,
             listing_id='686819099',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2021 Honda Civic EX',
             first_price=25904,
             listing_id='686735167',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2022 Chevrolet Malibu LT',
             first_price=26749,
             listing_id='686830354',
             price_ribbon=PriceRibbon.GOOD),
    ListItem(title='Certified 2020 Honda Accord Sport',
             first_price=27269,
             listing_id='686731430',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2021 Nissan Rogue SV',
             first_price=27953,
             listing_id='687319924',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2020 Jeep Grand Cherokee Laredo',
             first_price=28900,
             listing_id='687048402',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Certified 2020 Toyota Prius Limited',
             first_price=28999,
             listing_id='686807361',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Certified 2021 Chevrolet TrailBlazer ACTIV',
             first_price=29980,
             listing_id='686810345',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Certified 2023 Kia K5 GT-Line',
             first_price=32998,
             listing_id='687024670',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2022 Nissan Frontier SV',
             first_price=33490,
             listing_id='686925414',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2020 Ford Ranger XLT',
             first_price=33980,
             listing_id='686706222',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2020 Honda Pilot Touring',
             first_price=34228,
             listing_id='687011703',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2021 Acura TLX',
             first_price=36500,
             listing_id='686902492',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2022 Buick Envision Avenir',
             first_price=38900,
             listing_id='686810940',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2020 Jeep Grand Cherokee Overland',
             first_price=38995,
             listing_id='673953414',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Certified 2020 Cadillac CT5 Premium Luxury',
             first_price=39800,
             listing_id='687168551',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2021 RAM 1500 Big Horn',
             first_price=42778,
             listing_id='687040742',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2020 Ford Explorer ST',
             first_price=44900,
             listing_id='686725394',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2021 Toyota 4Runner Venture',
             first_price=47500,
             listing_id='686813576',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Used 2023 Buick Enclave Avenir',
             first_price=50998,
             listing_id='687198039',
             price_ribbon=PriceRibbon.GREAT),
    ListItem(title='Certified 2023 Buick Enclave Avenir',
             first_price=51900,
             listing_id='686728272',
             price_ribbon=PriceRibbon.GREAT)]
